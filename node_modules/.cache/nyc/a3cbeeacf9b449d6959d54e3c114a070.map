{"version":3,"sources":["token.js"],"names":["authenticate","req","res","next","bearerHeader","headers","authorization","error","status","send","bearerToken","split","token","jwt","verify","process","env","JWT_SECRET","err"],"mappings":";;;;;;AAAA;;;;;;AAEA,IAAMA,eAAe,SAAfA,YAAe,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACvC,MAAMC,eAAeH,IAAII,OAAJ,CAAYC,aAAjC;AACA,MAAMC,QAAQ,uBAAd;;AAEA,MAAI,OAAOH,YAAP,KAAwB,WAA5B,EAAyC;AACvC,WAAOF,IAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEF,YAAF,EAArB,CAAP;AACD;;AAED,MAAMG,cAAcN,aAAaO,KAAb,CAAmB,GAAnB,EAAwB,CAAxB,CAApB;AACAV,MAAIW,KAAJ,GAAYF,WAAZ;;AAEA,SAAOG,uBAAIC,MAAJ,CAAWb,IAAIW,KAAf,EAAsBG,QAAQC,GAAR,CAAYC,UAAlC,EAA8C,UAACC,GAAD,EAAS;AAC5D,QAAIA,GAAJ,EAAS;AACP,aAAOhB,IAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEF,YAAF,EAArB,CAAP;AACD;AACD,WAAOJ,MAAP;AACD,GALM,CAAP;AAMD,CAjBD;;kBAmBeH,Y","file":"token.js","sourceRoot":"/home/ibidapo/andela-bootcamp/send-it/lib/helper/authentication","sourcesContent":["import jwt from 'jsonwebtoken';\n\nconst authenticate = (req, res, next) => {\n  const bearerHeader = req.headers.authorization;\n  const error = 'Authentication failed';\n\n  if (typeof bearerHeader === 'undefined') {\n    return res.status(403).send({ error });\n  }\n\n  const bearerToken = bearerHeader.split(' ')[1];\n  req.token = bearerToken;\n\n  return jwt.verify(req.token, process.env.JWT_SECRET, (err) => {\n    if (err) {\n      return res.status(403).send({ error });\n    }\n    return next();\n  });\n};\n\nexport default authenticate;\n"]}